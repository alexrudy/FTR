<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FFT Normalization &mdash; FTR v0.0.dev329</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.dev329',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="FTR v0.0.dev329" href="../index.html" />
    <link rel="up" title="Fourier Transform Reconstructors" href="index.html" />
    <link rel="prev" title="C implementation of FTR in libFTR" href="libftr.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">FTR</span><span id="logotext2">AO</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="libftr.html" title="C implementation of FTR in libFTR">
	  &laquo; previous
	</a>
	
      </li>
      <li>
	<a href="../index.html">FTR v0.0.dev329</a>
	 &raquo;
      </li>
      <li><a href="index.html" accesskey="U">Fourier Transform Reconstructors</a> &raquo;</li>
      
      <li>FFT Normalization</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fft-normalization">
<h1>FFT Normalization<a class="headerlink" href="#fft-normalization" title="Permalink to this headline">¶</a></h1>
<p>Different FFT implementations often have different normalization parameters. Most FFTs will be defined such that a forward transform follwed by an inverse transform will result in the same values. However, implementations tend to apply the normalization at different points. This document describes the normalizations applied by each FFT, and their implications for the Fourier transform reconstructor.</p>
<p>The implementation of the FTR is taken from Lisa Poyneer&#8217;s IDL implementation (which is not) included in this distribution. However, we can use the IDL FFT definition to clarify our FFT normalization. This document shows how to modify other FFT normalizations so that they match the IDL normalization, the canonical one used in this algorithm. <a class="footnote-reference" href="#fidl" id="id1">[1]</a></p>
<table class="docutils footnote" frame="void" id="fidl" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>There is nothing <em>more</em> correct about the IDL implementation, it just happens to be the canonical implementation as it is the referernce implementaiton provided to match Lisa&#8217;s thesis.</td></tr>
</tbody>
</table>
<div class="section" id="idl-normalization">
<h2>IDL Normalization<a class="headerlink" href="#idl-normalization" title="Permalink to this headline">¶</a></h2>
<p>IDL defines the FFT (<a class="reference external" href="http://www.physics.nyu.edu/grierlab/idl_html_help/F4.html">here</a>) as</p>
<div class="math">
<p><img src="../_images/math/efc2f25ec9307038a0c0c7cf5a89f3d7893f9593.png" alt="F(u) = \frac{1}{N}\sum_{x = 0}^{N - 1} f(x) \exp\left[-j \frac{2 \pi u x}{N}\right]"/></p>
</div><p>and the inverse FFT as</p>
<div class="math">
<p><img src="../_images/math/ff6ec6e8bd942a8be6c5b03236e5de1cfea48047.png" alt="f(x) = \sum_{u = 0}^{N - 1} F(u) \exp\left[j \frac{2 \pi u x}{N}\right]"/></p>
</div><p>The important part of this definition for our purposes is the factor of <img class="math" src="../_images/math/c15f1be84475430c55bdc9c08568f6d6c62ec148.png" alt="\tfrac{1}{N}"/> which is applied to the forward transform.</p>
<p>When we apply the spatial filters used in the Fourier transform reconstructor, we apply two forward transforms (one for x, one for y), and one backwards transform. Collecting only the factors of <img class="math" src="../_images/math/c15f1be84475430c55bdc9c08568f6d6c62ec148.png" alt="\tfrac{1}{N}"/>, we get two factors due to the two forward transforms which are added together. No factor is included in the inverse transform.</p>
<p>The normalization factor for the full FTR filter is <img class="math" src="../_images/math/6fdf2a09687312077f404b70055fa6b4b8c431b7.png" alt="\tfrac{2}{N}"/>.</p>
</div>
<div class="section" id="numpy-normalization">
<h2>Numpy Normalization<a class="headerlink" href="#numpy-normalization" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.9)"><code class="xref py py-mod docutils literal"><span class="pre">numpy</span></code></a> defines the forward FFT (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.fft.html#implementation-details">see here</a>) as</p>
<div class="math">
<p><img src="../_images/math/997b63ed3dab1bde197dddb5f31c65c70bfebedd.png" alt="A_k =  \sum_{m=0}^{n-1} a_m \exp\left\{-2\pi i{mk \over n}\right\}
\qquad k = 0,\ldots,n-1."/></p>
</div><p>and the inverse FFT as</p>
<div class="math">
<p><img src="../_images/math/d5938919cc7fbfc52c7ee2e434fca037a0cfd7fd.png" alt="a_m = \frac{1}{n}\sum_{k=0}^{n-1}A_k\exp\left\{2\pi i{mk\over n}\right\}
\qquad m = 0,\ldots,n-1."/></p>
</div><p>Comparing this definition to the one used by IDL, we can see that the normalization is applied as a <img class="math" src="../_images/math/6036e9173b678f4ecb2f2768595ddfb662a20517.png" alt="\tfrac{1}{n}"/> factor in the inverse transform.</p>
<p>Comparing to the IDL implementation, when we apply the two forward transforms, then add them, and apply a single reverse transform, we find that the total normalization is <img class="math" src="../_images/math/6036e9173b678f4ecb2f2768595ddfb662a20517.png" alt="\tfrac{1}{n}"/>. Therefore, we should multiply the Fourier transform of the phase estimate by 2 to match the normalization used by IDL.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FFT Normalization</a><ul>
<li><a class="reference internal" href="#idl-normalization">IDL Normalization</a></li>
<li><a class="reference internal" href="#numpy-normalization">Numpy Normalization</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/FTR/fftnormalization.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2015, Alex Rudy.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 16 Oct 2015. <br/>
  </p>
</footer>
  </body>
</html>